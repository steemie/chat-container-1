<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¿ƒçµæ ‘æ´ - æƒ…æ„Ÿç–å¯¼åŠ©æ‰‹</title>
    <style>
        /* ç®€å•çš„æ ·å¼ï¼Œè¥é€ æ¸©é¦¨æ°›å›´ */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f4f8; margin: 0; display: flex; justify-content: center; height: 100vh; }
        .chat-container { width: 100%; max-width: 600px; background: white; display: flex; flex-direction: column; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .header { background: #6a8caf; color: white; padding: 20px; text-align: center; font-size: 1.2em; font-weight: bold; }
        .chat-box { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px; }
        .message { max-width: 80%; padding: 12px 16px; border-radius: 15px; line-height: 1.5; font-size: 0.95em; position: relative; word-wrap: break-word; }
        .user-msg { align-self: flex-end; background-color: #6a8caf; color: white; border-bottom-right-radius: 2px; }
        .ai-msg { align-self: flex-start; background-color: #e9ecef; color: #333; border-bottom-left-radius: 2px; }
        .input-area { padding: 20px; border-top: 1px solid #eee; display: flex; gap: 10px; background: #fff; }
        input { flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 25px; outline: none; transition: 0.3s; }
        input:focus { border-color: #6a8caf; }
        button { padding: 10px 25px; background: #6a8caf; color: white; border: none; border-radius: 25px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        button:hover { background: #557291; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        .loading { font-style: italic; color: #888; font-size: 0.8em; margin-left: 10px; display: none; }
        
        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 480px) { .chat-container { height: 100vh; box-shadow: none; } }
    </style>
</head>
<body>

<div class="chat-container">
    <div class="header">ğŸŒ¿ å¿ƒçµæ ‘æ´ | ä½ çš„ä¸“å±æƒ…æ„Ÿç–å¯¼å‘˜</div>
    <div class="chat-box" id="chatBox">
        <div class="message ai-msg">ä½ å¥½å‘€ï¼Œæˆ‘æ˜¯ä½ çš„æƒ…æ„Ÿæ ‘æ´ã€‚è¿™é‡Œå¾ˆå®‰å…¨ï¼Œä½ å¯ä»¥æ”¾å¿ƒåœ°è¯´å‡ºå¿ƒé‡Œçš„çƒ¦æ¼ã€å§”å±ˆæˆ–å¿«ä¹ã€‚æˆ‘ä¼šä¸€ç›´åœ¨è¿™é‡Œå€¾å¬ã€‚</div>
    </div>
    <div class="loading" id="loadingIndicator">æ­£åœ¨æ€è€ƒå¦‚ä½•å®‰æ…°ä½ ...</div>
    <div class="input-area">
        <input type="text" id="userInput" placeholder="ä»Šå¤©å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ..." onkeypress="if(event.key==='Enter') sendMessage()">
        <button onclick="sendMessage()" id="sendBtn">å‘é€</button>
    </div>
</div>

<script>
    // ================= é…ç½®åŒºåŸŸ =================
    // âš ï¸ è¯·åœ¨è¿™é‡Œå¡«å…¥ä½ åˆšæ‰ç”³è¯·çš„ DeepSeek API Key
    const API_KEY = 'PLEASE_REPLACE_ME'; 
    const API_URL = 'https://api.deepseek.com/chat/completions'; 
    
    // è®¾å®šäººè®¾ï¼šæ¸©æš–ã€å…±æƒ…ã€ä¸è¯„åˆ¤ã€å¼•å¯¼å¼æé—®
    const SYSTEM_PROMPT = `ä½ æ˜¯ä¸€ä½æ¸©æš–ã€ä¸“ä¸šä¸”å¯Œæœ‰åŒç†å¿ƒçš„æƒ…æ„Ÿç–å¯¼å’¨è¯¢å¸ˆã€‚
    ä½ çš„ä»»åŠ¡æ˜¯å€¾å¬ç”¨æˆ·çš„çƒ¦æ¼ï¼Œæä¾›æƒ…ç»ªä»·å€¼ï¼Œè€Œä¸æ˜¯å•çº¯çš„è¯´æ•™ã€‚
    åŸåˆ™ï¼š
    1. é¦–å…ˆæ¥çº³ç”¨æˆ·çš„æƒ…ç»ªï¼Œè¡¨ç¤ºç†è§£ï¼ˆå…±æƒ…ï¼‰ã€‚
    2. è¯­æ°”æ¸©æŸ”ã€å¹³å’Œï¼Œåƒä¸€ä½è€æœ‹å‹ã€‚
    3. å¤šä½¿ç”¨å¼€æ”¾å¼æé—®ï¼Œå¼•å¯¼ç”¨æˆ·è¡¨è¾¾æ›´å¤šï¼Œå¸®åŠ©ç”¨æˆ·ç†æ¸…æ€ç»ªã€‚
    4. å¦‚æœç”¨æˆ·æœ‰æç«¯æ¶ˆææˆ–è‡ªæ®‹å€¾å‘ï¼Œè¯·æ¸©æŸ”åœ°å»ºè®®å¯»æ±‚ä¸“ä¸šåŒ»ç”Ÿå¸®åŠ©ï¼Œå¹¶æä¾›å¿ƒç†æ´åŠ©çƒ­çº¿ï¼ˆå¦‚ï¼šå¸Œæœ›24çƒ­çº¿ 400-161-9995ï¼‰ã€‚
    5. å›ç­”è¦ç®€æ´ï¼Œä¸è¦é•¿ç¯‡å¤§è®ºï¼Œä¿æŒå¯¹è¯çš„è‡ªç„¶æµç•…ã€‚`;
    
    let conversationHistory = [
        { role: "system", content: SYSTEM_PROMPT }
    ];

    // ================= é€»è¾‘åŒºåŸŸ =================
    const chatBox = document.getElementById('chatBox');
    const userInput = document.getElementById('userInput');
    const sendBtn = document.getElementById('sendBtn');
    const loadingIndicator = document.getElementById('loadingIndicator');

    async function sendMessage() {
        const text = userInput.value.trim();
        if (!text) return;

        // 1. æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯
        addMessage(text, 'user-msg');
        userInput.value = '';
        userInput.disabled = true;
        sendBtn.disabled = true;
        loadingIndicator.style.display = 'block';

        // 2. è®°å½•å†å²
        conversationHistory.push({ role: "user", content: text });

        try {
            // 3. è°ƒç”¨ API
            const response = await fetch(API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${API_KEY}`
                },
                body: JSON.stringify({
                    model: "deepseek-chat", // æˆ–è€… deepseek-reasoner
                    messages: conversationHistory,
                    temperature: 0.7, // ç¨å¾®é«˜ä¸€ç‚¹ï¼Œæ›´æœ‰åˆ›é€ åŠ›åŠäººæƒ…å‘³
                    max_tokens: 500
                })
            });

            if (!response.ok) throw new Error('ç½‘ç»œè¯·æ±‚å¤±è´¥');

            const data = await response.json();
            const aiReply = data.choices[0].message.content;

            // 4. æ˜¾ç¤º AI æ¶ˆæ¯
            addMessage(aiReply, 'ai-msg');
            conversationHistory.push({ role: "assistant", content: aiReply });

        } catch (error) {
            addMessage("æŠ±æ­‰ï¼Œæˆ‘åˆšæ‰èµ°ç¥äº†ï¼ˆç½‘ç»œé”™è¯¯ï¼‰ï¼Œè¯·å†è¯•ä¸€æ¬¡å¥½å—ï¼Ÿ", 'ai-msg');
            console.error(error);
        } finally {
            userInput.disabled = false;
            sendBtn.disabled = false;
            loadingIndicator.style.display = 'none';
            userInput.focus();
            chatBox.scrollTop = chatBox.scrollHeight;
        }
    }

    function addMessage(text, className) {
        const div = document.createElement('div');
        div.className = `message ${className}`;
        div.innerText = text;
        chatBox.appendChild(div);
        chatBox.scrollTop = chatBox.scrollHeight;
    }
</script>

</body>
</html>